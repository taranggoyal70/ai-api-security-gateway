<!DOCTYPE html>
<html>
<head>
    <title>AI Security Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }
        .container {
            background: #16213e;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        button {
            background: #0f3460;
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #e94560;
        }
        .result {
            background: #0f0f0f;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
            min-height: 150px;
            font-family: monospace;
        }
        .allow { color: #00ff00; }
        .block { color: #ff0000; }
        .sanitize { color: #ffa500; }
        h1 { text-align: center; }
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
        }
        .stat {
            text-align: center;
            padding: 20px;
            background: #0f3460;
            border-radius: 10px;
        }
        .stat-num {
            font-size: 3em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ü§ñ AI Security Agent Testing</h1>
    
    <div class="stats">
        <div class="stat">
            <div class="stat-num" id="total">0</div>
            <div>Total Tests</div>
        </div>
        <div class="stat">
            <div class="stat-num allow" id="allowed">0</div>
            <div>Allowed</div>
        </div>
        <div class="stat">
            <div class="stat-num block" id="blocked">0</div>
            <div>Blocked</div>
        </div>
    </div>

    <div class="container">
        <h2>Request Analysis</h2>
        <button onclick="testNormal()">‚úÖ Test Normal Request</button>
        <button onclick="testSQL()">‚ùå Test SQL Injection</button>
        <button onclick="testXSS()">‚ùå Test XSS Attack</button>
        <button onclick="testMalicious()">‚ùå Test Malicious API</button>
        <button onclick="testAPIKey()">‚ùå Test API Key Leak</button>
        
        <div class="result" id="result1">Click a button above to test AI security analysis...</div>
    </div>

    <div class="container">
        <h2>Response Analysis</h2>
        <button onclick="testCleanResponse()">‚úÖ Test Clean Response</button>
        <button onclick="testXSSResponse()">üßπ Test XSS in Response</button>
        <button onclick="testPIIResponse()">üßπ Test PII Leak</button>
        
        <div class="result" id="result2">Click a button above to test response analysis...</div>
    </div>

    <script>
        let stats = {total: 0, allowed: 0, blocked: 0};

        function updateStats() {
            document.getElementById('total').textContent = stats.total;
            document.getElementById('allowed').textContent = stats.allowed;
            document.getElementById('blocked').textContent = stats.blocked;
        }

        function showResult(resultId, decision, risk, reasoning, threats) {
            const el = document.getElementById(resultId);
            const decisionClass = decision.toLowerCase();
            
            let threatText = '';
            if (threats && threats.length > 0) {
                threatText = '\n\nThreats Detected:\n‚Ä¢ ' + threats.join('\n‚Ä¢ ');
            }
            
            el.innerHTML = `<strong>ü§ñ AI SECURITY ANALYSIS</strong>

<strong>Decision:</strong> <span class="${decisionClass}">${decision}</span>
<strong>Risk Level:</strong> ${risk}
<strong>Confidence:</strong> 95%

<strong>AI Reasoning:</strong>
${reasoning}${threatText}`;
        }

        function testNormal() {
            const el = document.getElementById('result1');
            el.textContent = 'ü§ñ AI Analyzing...\n\nPlease wait...';
            
            setTimeout(() => {
                stats.total++;
                stats.allowed++;
                updateStats();
                showResult('result1', 'ALLOW', 'LOW', 
                    'AI analysis complete. Request appears safe. The API is trusted, parameters are clean, and no malicious patterns detected.', 
                    []);
            }, 1500);
        }

        function testSQL() {
            const el = document.getElementById('result1');
            el.textContent = 'ü§ñ AI Analyzing...\n\nDetecting SQL injection patterns...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result1', 'BLOCK', 'CRITICAL', 
                    'AI detected SQL injection pattern. The parameter contains SQL syntax attempting to bypass authentication or extract data. This is a classic SQL injection attack using OR 1=1 logic.', 
                    ['SQL_INJECTION', 'AUTHENTICATION_BYPASS']);
            }, 1500);
        }

        function testXSS() {
            const el = document.getElementById('result1');
            el.textContent = 'ü§ñ AI Analyzing...\n\nChecking for XSS patterns...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result1', 'BLOCK', 'HIGH', 
                    'AI detected XSS attack pattern. The parameter contains script tags that could execute malicious JavaScript in the browser.', 
                    ['XSS', 'SCRIPT_INJECTION']);
            }, 1500);
        }

        function testMalicious() {
            const el = document.getElementById('result1');
            el.textContent = 'ü§ñ AI Analyzing...\n\nChecking API trustworthiness...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result1', 'BLOCK', 'CRITICAL', 
                    'AI identified this as an untrusted API domain. The domain name suggests malicious intent and is not in the allowlist of trusted APIs.', 
                    ['UNTRUSTED_API', 'SSRF_RISK']);
            }, 1500);
        }

        function testAPIKey() {
            const el = document.getElementById('result1');
            el.textContent = 'ü§ñ AI Analyzing...\n\nChecking for sensitive data leaks...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result1', 'BLOCK', 'CRITICAL', 
                    'AI detected potential API key in parameters. This could lead to unauthorized access if the request is logged or intercepted. API keys should never be sent in URL parameters.', 
                    ['API_KEY_LEAK', 'SENSITIVE_DATA_EXPOSURE']);
            }, 1500);
        }

        function testCleanResponse() {
            const el = document.getElementById('result2');
            el.textContent = 'ü§ñ AI Analyzing Response...\n\nChecking for malicious content...';
            
            setTimeout(() => {
                stats.total++;
                stats.allowed++;
                updateStats();
                showResult('result2', 'ALLOW', 'LOW', 
                    'AI analysis complete. Response appears safe. No malicious content, XSS, or PII leakage detected in the API response.', 
                    []);
            }, 1500);
        }

        function testXSSResponse() {
            const el = document.getElementById('result2');
            el.textContent = 'ü§ñ AI Analyzing Response...\n\nScanning for XSS...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result2', 'SANITIZE', 'HIGH', 
                    'AI detected XSS content in API response. The response contains script tags that could execute malicious code if rendered in a browser. Response will be sanitized before returning to the application.', 
                    ['XSS_IN_RESPONSE', 'MALICIOUS_SCRIPT']);
            }, 1500);
        }

        function testPIIResponse() {
            const el = document.getElementById('result2');
            el.textContent = 'ü§ñ AI Analyzing Response...\n\nChecking for PII exposure...';
            
            setTimeout(() => {
                stats.total++;
                stats.blocked++;
                updateStats();
                showResult('result2', 'SANITIZE', 'MEDIUM', 
                    'AI detected PII in response. Found email addresses, SSN, and phone numbers that should be masked for privacy compliance. Data will be sanitized before returning.', 
                    ['PII_EXPOSURE', 'EMAIL_LEAK', 'SSN_DETECTED']);
            }, 1500);
        }
    </script>
</body>
</html>
